<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8"/><style>
table {border: medium solid #6495ed;border-collapse: collapse;width: 100%;} th{font-family: monospace;border: thin solid #6495ed;padding: 5px;background-color: #D0E3FA;}td{font-family: sans-serif;border: thin solid #6495ed;padding: 5px;text-align: center;}.odd{background:#e8edff;}img{padding:5px; border:solid; border-color: #dddddd #aaaaaa #aaaaaa #dddddd; border-width: 1px 2px 2px 1px; background-color:white;}</style>
</head>
<body>
<table><tr><th colspan="1">explain<br>select <br>	to_char(s.order_dt::timestamp, 'YYYY-Mon') as "Sales month",<br>	sum(s.order_amt * p.price) as "Sales sum"<br>from sales s <br>	join products p using(goods_id)<br>group by to_char(s.order_dt::timestamp, 'YYYY-Mon')<br>order by 1</th></tr><tr><th>QUERY PLAN</th></tr><tr class="odd"><td>Gather Motion 2:1  (slice3; segments: 2)  (cost=0.00..862.00 rows=1 width=16)</td></tr>
<tr><td>  Merge Key: (to_char(sales.order_dt::timestamp without time zone, 'YYYY-Mon'::text))</td></tr>
<tr class="odd"><td>  -&gt;  GroupAggregate  (cost=0.00..862.00 rows=1 width=16)</td></tr>
<tr><td>        Group By: (to_char(sales.order_dt::timestamp without time zone, 'YYYY-Mon'::text))</td></tr>
<tr class="odd"><td>        -&gt;  Sort  (cost=0.00..862.00 rows=1 width=16)</td></tr>
<tr><td>              Sort Key: (to_char(sales.order_dt::timestamp without time zone, 'YYYY-Mon'::text))</td></tr>
<tr class="odd"><td>              -&gt;  Redistribute Motion 2:2  (slice2; segments: 2)  (cost=0.00..862.00 rows=1 width=16)</td></tr>
<tr><td>                    Hash Key: (to_char(sales.order_dt::timestamp without time zone, 'YYYY-Mon'::text))</td></tr>
<tr class="odd"><td>                    -&gt;  Result  (cost=0.00..862.00 rows=1 width=16)</td></tr>
<tr><td>                          -&gt;  GroupAggregate  (cost=0.00..862.00 rows=1 width=16)</td></tr>
<tr class="odd"><td>                                Group By: (to_char(sales.order_dt::timestamp without time zone, 'YYYY-Mon'::text))</td></tr>
<tr><td>                                -&gt;  Sort  (cost=0.00..862.00 rows=1 width=16)</td></tr>
<tr class="odd"><td>                                      Sort Key: (to_char(sales.order_dt::timestamp without time zone, 'YYYY-Mon'::text))</td></tr>
<tr><td>                                      -&gt;  Result  (cost=0.00..862.00 rows=1 width=16)</td></tr>
<tr class="odd"><td>                                            -&gt;  Hash Join  (cost=0.00..862.00 rows=1 width=12)</td></tr>
<tr><td>                                                  Hash Cond: products.goods_id::text = sales.goods_id::text</td></tr>
<tr class="odd"><td>                                                  -&gt;  Table Scan on products  (cost=0.00..431.00 rows=5 width=37)</td></tr>
<tr><td>                                                  -&gt;  Hash  (cost=431.00..431.00 rows=1 width=16)</td></tr>
<tr class="odd"><td>                                                        -&gt;  Redistribute Motion 2:2  (slice1; segments: 2)  (cost=0.00..431.00 rows=1 width=16)</td></tr>
<tr><td>                                                              Hash Key: sales.goods_id</td></tr>
<tr class="odd"><td>                                                              -&gt;  Sequence  (cost=0.00..431.00 rows=1 width=16)</td></tr>
<tr><td>                                                                    -&gt;  Partition Selector for sales (dynamic scan id: 1)  (cost=10.00..100.00 rows=50 width=4)</td></tr>
<tr class="odd"><td>                                                                          Partitions selected: 12 (out of 12)</td></tr>
<tr><td>                                                                    -&gt;  Dynamic Table Scan on sales (dynamic scan id: 1)  (cost=0.00..431.00 rows=1 width=16)</td></tr>
<tr class="odd"><td>Settings:  optimizer=on</td></tr>
<tr><td>Optimizer status: PQO version 3.21.0</td></tr>
</table></body></html>