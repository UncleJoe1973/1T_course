**Задание ПРО (новое)**

1. Разделите логику вашего Python-оператора из предыдущего задания следующим образом:

* В отдельном операторе получите значения из API и запишите их в XCOM.
* В следующем операторе получите эти значения из XCOM и запишите в базу.

2. Добавьте в начало вашего dag’a оператор, который вычисляет количество строк в базе и записывает в специальную переменную airflow.
3. Добавьте SensorOperator, а за ним еще один оператор, который рассчитывает следующие показатели:

* максимальное значение курса,
* минимальное значение курса,
* среднее значение курса за весь период

  и добавляет (обновляет) эти показатели в отдельную таблицу. Логика аналогична пункту 3 в задании 3.2. При этом скрипт расчета показателей должен запускаться только в том случае, если в таблице появилась новая запись. При этом в случае невыполнения условия airflow dag должен игнорировать пересчет последнего оператора и «мягко» завершаться.
  
   По итогу выполнения всех пунктов задания вам необходимо прислать ссылку на ваш репозиторий.
