**Задание ПРО**

1. Создайте переменную (Admin->Variables), в которой пропишите путь к raw_data
2. Создайте connection (Admin->connections), в котором пропишите настройки соединения к БД raw_store

В новом созданном DAGe

3. Создайте пустой таск, используя DammyOperator, назовите его “start”
4. Далее, используя BashOperator, создайте таск, который создаст папку /raw_data/supermarket_1
5. Далее, используя PythonOperator создайте таск, который загружает данные из csv файла [Yandex](https://disk.yandex.com.am/d/wMKRLK7gNL09Dg) в raw_store как есть. При выполнении данного пункта используйте созданное соединение (connection)
6. Дополните ваш DAG, написав Sendor, который проверяет наличие файла в папке /raw_data/supermarket_1. Загрузку данных на шаге 5. Осуществлять, если файл существует

_Задание 2 (формирование CORE)_

1. Напишите таск или группу тасков, которые формируют CORE-слой. CORE слой должен быть нормализован. (архитектуру CORE выбирайте сами)

Примечание: формирование CORE-слоя можно сделать на этапе развертывания airflow (в докер-compose) при помощи скриптов

2. Далее, напишите таск, который реализует следующую логику:

  a) Ваши загруженные данные содержат столбцы Order Date и Ship Date с датами в виде MM/DD/YYYY
  
  b) Ваша задача преобразовать данные в указанных столбцах к виду YYYY-MM-DD
  
  c) Отфильтровать исходный источник данных и выбрать данные, относящиеся только к корпоративному сегменту
  
  d) Полученную отфильтрованную выборку записать базу core_store

Варианты реализации: (можете выбрать любой)

1. Используйте PythonOperator, а также библиотеку psycopg2 для работы с БД Postgres
2. Используйте PostgresOperator

_Задание 3. Формирование Data MART_

Для отчетности, аналитики запросили следящие данные.

Витрина 1
Вывести по каждому году, общую сумму заказов по категориям корпоративного сегмента.
Данную витрину записать в mart_store

Витрина 2

1. Используя PythonOperator напишите task, который случайным образом возвращает одно из возможных значений атрибута "Category" в наборе данных о заказах супермаркета.
2. Использовать механизм XCOM для передачи полученного значения Category (п.1) следующей задаче (см.п.3)
3. Напишите task, который реализует следующую логику: в зависимости от возвращенного значения Category найдите итоговую сумму заказов по каждой из суб-категорий выбранной категории в корпоративном сегменте за 2015 год. Результат вычислений запишите в mart_store. Для выполнения данного пункта, использовать BranchPythonOperator
4. Далее, Создайте пустой таск, используя DammyOperator, назовите его “end”

В результате выполнения задания необходимо предоставить:

1. Исходный код DAGa
2. Скриншот построенного DAGa в Airflow
3. Скриншот витрины mart_store

Результат выполнения задания необходимо выложить в github/gitlab и указать ссылку на Ваш репозиторий (не забудьте — репозиторий должен быть публичным).
